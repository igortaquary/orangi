$("#contact-form").validator().on("submit", function (event) {
    if (event.isDefaultPrevented()) {
        // handle the invalid form...
        formError();
        submitMSG(false, "Verifique os dados da mensagem");
    } else {
        // everything looks good!
        event.preventDefault();
        handleSubmit(event);
    }
});

var form = document.getElementById("contact-form");
    
async function handleSubmit(event) {

    //var status = document.getElementById("my-form-status");
    var data = new FormData(event.target);
    const formUrl = "https://formspree.io/f/xdobdboz";
    fetch(formUrl, {
    method: "POST",
    body: data,
    headers: {
        'Accept': 'application/json'
    }
    }).then(response => {
    if (response.ok) {
        formSuccess()
        /* status.innerHTML = "Thanks for your submission!";
        form.reset() */
    } else {
        formError();
        submitMSG(false, "Houve um problema ao enviar seu formulário");
        /* response.json().then(data => {
        if (Object.hasOwn(data, 'errors')) {
            submitMSG(false, data["errors"].map(error => error["message"]).join(", "));
            //status.innerHTML = data["errors"].map(error => error["message"]).join(", ")
        } else {
            submitMSG(false, "Houve um problema ao enviar seu formulário");
            //status.innerHTML = "Oops! There was a problem submitting your form"
        }
        }) */
    }
    }).catch(error => {
        formError();
        submitMSG(false, "Houve um problema ao enviar seu formulário");
        //status.innerHTML = "Oops! There was a problem submitting your form"
    });
}

//form.addEventListener("submit", handleSubmit)

function formSuccess(){
    $("#contact-form")[0].reset();
    submitMSG(true, "Mensagem enviada! Entraremos em contato em breve.")
}

function formError(){
    $("#contact-form").removeClass().addClass('shake animated').one('webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend', function(){
        $(this).removeClass();
    });
}

function submitMSG(valid, msg){
    if(valid){
        var msgClasses = "h3 text-left tada animated text-success";
    } else {
        var msgClasses = "h3 text-left text-danger";
    }
    $("#msgSubmit").removeClass().addClass(msgClasses).text(msg);
}